var hivepress={getSelector:function(a){return"[data-component=\""+a+"\"]"},getComponent:function(a){return jQuery(this.getSelector(a))}};(function(a){"use strict";hivepress.initUI=function(b=null){null===b&&(b=a("body")),b.find(hivepress.getSelector("link")).on("click",function(b){var c=a(this).data("url");0!==c.indexOf("#")&&(window.location.href=c),b.preventDefault()}),b.find("input[type=url]").focusout(function(){var b=a(this).val();!b||b.startsWith("https://")||b.startsWith("http://")||a(this).val("https://"+b)}),b.find(hivepress.getSelector("modal")).each(function(){var b="#"+a(this).attr("id");a("a[href=\""+b+"\"], button[data-url=\""+b+"\"]").on("click",function(c){a.fancybox.close(),a.fancybox.open({src:b,touch:!1}),c.preventDefault()})}),b.find(hivepress.getSelector("repeater")).each(function(){var b=a(this),c=b.find("tbody");c.find(":input[required]").removeAttr("required");var d=b.find("tr:first"),e=d.clone();c.sortable({handle:"[data-sort]"}),d.length&&b.find("[data-add]").on("click",function(){var b=e.clone(),d=Math.random().toString(36).slice(2);d&&(b.find(":input").each(function(){var b=a(this),c=b.attr("name"),e=c.match(/\[([^\]]+)\]/);if(e&&b.attr("name",c.replace(e[1],d)),"checkbox"===b.attr("type")){var f="a"+Math.random().toString(36).slice(2);b.attr("id",f),b.closest("label").attr("for",f)}else b.val("")}),b.appendTo(c)),hivepress.initUI(b)}),b.on("click","[data-remove]",function(){1<b.find("tr").length&&a(this).closest("tr").remove()})}),b.find(hivepress.getSelector("select")).each(function(){var b=a(this),c={width:"100%",dropdownAutoWidth:!1,minimumResultsForSearch:20,templateResult:function(b){var c=b.text,d=0;return b.element&&(d=parseInt(a(b.element).data("level")),c=a("<div />").css("padding-left",20*d+"px").text(c)),c}};if(b.data("placeholder")&&(c.placeholder=b.data("placeholder")),"inline"===b.data("style")&&a.extend(c,{containerCssClass:"select2-selection--inline",dropdownCssClass:"select2-dropdown--inline",width:"resolve",dropdownAutoWidth:!0,minimumResultsForSearch:-1}),"icon"===b.data("template")){var d=function(a){var b=a.text;return a.id&&(b="<i class=\"fas fa-fw fa-"+a.id+"\"></i> "+a.text),b};a.extend(c,{templateResult:d,templateSelection:d,escapeMarkup:function(a){return a}})}if(b.data("source"))if(a.extend(c,{ajax:{url:b.data("source"),dataType:"json",delay:250,cache:!0,data:function(a){return{search:a.term,context:"list",parent_value:b.data("parent-value"),_wpnonce:hivepressCoreData.apiNonce}},processResults:function(a){var b=[];return a&&a.hasOwnProperty("data")&&(b=a.data),{results:b}}}}),b.data("parent")){var e=b.closest("form").find(":input[name=\""+b.data("parent")+"\"]");e.length&&e.on("change",function(){b.data("parent-value",a(this).val())})}else c.minimumInputLength=3;if(b.data("input")&&a.extend(c,{tags:!0,tokenSeparators:[","]}),b.data("multistep")){var f=[];b.find("option").each(function(){var b=a(this);f.push({id:parseInt(b.val()),text:b.text(),parent:parseInt(b.data("parent"))})});var g=parseInt(b.val()),h=f.find(function(a){return a.id===g});if(h&&h.parent){var i=f.filter(function(a){return a.id===h.parent||a.parent===h.parent});1<i.length&&(i[0]=a.extend({},i[0],{id:i[0].parent,text:"\u2190 "+i[0].text}),b.html("").select2(a.extend({},c,{data:i})),b.val(g).trigger("change"))}else b.find("option[data-level]").remove()}b.on("select2:select",function(){var b=a(this);if(b.data("multistep")){var d=parseInt(b.val()),e=f.filter(function(a){return a.id===d||a.parent===d});if(!d||1<e.length)return d?e[0]=a.extend({},e[0],{id:e[0].parent,text:"\u2190 "+e[0].text}):e=f.filter(function(a){return!a.parent}),b.html("").select2(a.extend({},c,{data:e})),b.val(null),b.select2("open"),!1}if(b.data("render")){var g=b.closest("[data-model]"),h=new FormData(b.closest("form").get(0)),i=[],j=[];h.append("_id",g.data("id")),h.append("_model",g.data("model")),h.delete("_wpnonce"),g.attr("data-state","loading"),a.ajax({url:b.data("render"),method:"POST",data:h,contentType:!1,processData:!1,beforeSend:function(b){b.setRequestHeader("X-WP-Nonce",hivepressCoreData.apiNonce),"undefined"!=typeof tinyMCE&&(a.each(tinymce.editors,function(a,b){i.push(b.settings),j.push(b.id)}),a.each(j,function(a,b){tinymce.remove("#"+b)}))},complete:function(b){var c=b.responseJSON;if("undefined"!=typeof c&&c.hasOwnProperty("data")&&c.data.hasOwnProperty("html")){var d=a(c.data.html);if(g.replaceWith(d),hivepress.initUI(d),"undefined"!=typeof tinyMCE&&a.each(i,function(a,b){tinymce.init(b)}),"undefined"!=typeof grecaptcha){var e=d.find(".g-recaptcha");e.length&&e.data("sitekey")&&grecaptcha.render(e.get(0),{sitekey:e.data("sitekey")})}}}})}}),b.data("select2-id")||b.select2(c)}),b.find(hivepress.getSelector("phone")).each(function(){var b=a(this),c={hiddenInput:b.attr("name"),preferredCountries:[],separateDialCode:!0,utilsScript:b.data("utils")};b.removeAttr("name"),b.data("countries")&&(c.onlyCountries=b.data("countries")),b.data("country")&&(c.initialCountry=b.data("country")),window.intlTelInput(b.get(0),c)}),b.find(hivepress.getSelector("date")).each(function(){var b=Math.floor,c=a(this),d={allowInput:!0,altInput:!0,dateFormat:"Y-m-d",altFormat:"Y-m-d",defaultHour:0,disable:[],disableMobile:!0,onOpen:function(b,c,d){a(d.altInput).prop("readonly",!0),a(d.element).find("[data-clear]").show()},onClose:function(b,c,d){a(d.altInput).prop("readonly",!1),a(d.altInput).blur(),a(d.element).find("[data-clear]").hide(),a(d.element).data("reset")&&(d.clear(),a(d.element).data("reset",!1))}};if(c.is("div")&&(d.wrap=!0,d.altInputClass="",c.find("[data-clear]").on("click",function(){c.data("reset",!0)})),c.data("format")&&(d.dateFormat=c.data("format")),c.data("display-format")&&(d.altFormat=c.data("display-format")),c.data("time")&&(d.enableTime=!0),c.is("[data-offset]")&&(d.minDate=new Date().fp_incr(c.data("offset"))),c.data("min-date")&&(d.minDate=c.data("min-date")),c.is("[data-window]")&&(d.maxDate=new Date().fp_incr(c.data("window"))),c.data("max-date")&&(d.maxDate=c.data("max-date")),c.data("enabled-dates")&&(d.enable=c.data("enabled-dates")),c.data("disabled-dates")&&(d.disable=c.data("disabled-dates")),c.data("disabled-days")){var e=c.data("disabled-days");if(e.length){d.disable.push(function(a){return-1!==e.indexOf(a.getDay())})}}if(c.data("ranges")){var f=c.data("ranges");d.onDayCreate=function(c,d,e,g){if(!g.className.includes("disabled")){var h=b(g.dateObj.getTime()/1e3)-60*g.dateObj.getTimezoneOffset();a.each(f,function(a,b){if(b.start<=h&&h<b.end)return g.innerHTML+="<span class=\"flatpickr-day-label\">"+b.label+"</span>",g.className+=" flatpickr-status",b.hasOwnProperty("status")&&(g.className+=" flatpickr-status--"+b.status),!1})}}}if(c.data("mode")&&(d.mode=c.data("mode"),"range"===c.data("mode"))){var g=c.parent().find("input[type=\"hidden\"]").not(c),h=c.data("min-length"),i=c.data("max-length");a.extend(d,{defaultDate:[g.eq(0).val(),g.eq(1).val()],errorHandler:function(){},onChange:function(a,c,e){if(2===a.length){if(h||i){var f=b((a[1].getTime()-a[0].getTime())/86400000),j=0;f<h?j=h-f:f>i&&(j=i-f),j&&(a[1].setDate(a[1].getDate()+j),e.setDate(a),e.open())}var k=a.map(function(a){return hivepress.dateFormatter.formatDate(a,d.dateFormat)});g.eq(0).val(k[0]),g.eq(1).val(k[1])}else g.eq(0).val(""),g.eq(1).val("")}})}a.extend(d,{time_24hr:-1===d.altFormat.indexOf("a")&&-1===d.altFormat.indexOf("A"),parseDate:function(a,b){var c=hivepress.dateFormatter.parseDate(a,b);return"U"===b&&(c=new Date(c.toLocaleString("en-US",{timeZone:"UTC"}))),c},formatDate:function(a,b){var c=hivepress.dateFormatter.formatDate(a,b);return"U"===b&&(c=parseInt(c)-60*a.getTimezoneOffset()),c}}),c.flatpickr(d)}),b.find(hivepress.getSelector("time")).each(function(){var b=a(this),c={allowInput:!0,altInput:!0,noCalendar:!0,enableTime:!0,dateFormat:"U",altFormat:"g:i A",defaultHour:0,disableMobile:!0,parseDate:function(a,b){var c=hivepress.dateFormatter.parseDate(a,b);return parseInt(a)||(c=hivepress.dateFormatter.parseDate(1,b)),"U"===b&&(c=new Date(c.toLocaleString("en-US",{timeZone:"UTC"}))),c},formatDate:function(a,b){return"U"===b?3600*a.getHours()+60*a.getMinutes()+a.getSeconds():hivepress.dateFormatter.formatDate(a,b)},onOpen:function(b,c,d){a(d.altInput).prop("readonly",!0),a(d.element).find("[data-clear]").show()},onClose:function(b,c,d){a(d.altInput).prop("readonly",!1),a(d.altInput).blur(),a(d.element).find("[data-clear]").hide(),a(d.element).data("reset")&&(d.clear(),a(d.element).data("reset",!1))}};b.is("div")&&(c.wrap=!0,c.altInputClass="",b.find("[data-clear]").on("click",function(){b.data("reset",!0)})),b.data("display-format")&&(c.altFormat=b.data("display-format")),-1===c.altFormat.indexOf("a")&&-1===c.altFormat.indexOf("A")&&(c.time_24hr=!0),b.flatpickr(c)}),b.find(hivepress.getSelector("file-upload")).each(function(){var b=a(this),c=b.parents("[data-model]:first"),d=b.closest("form").find(":submit"),e=b.closest("label"),f=e.find("button").first(),g=e.parent().find(hivepress.getSelector("messages")).first(),h=e.parent().children("div").first();b.fileupload({url:b.data("url"),dataType:"json",paramName:"file",limitConcurrentUploads:2,formData:{parent_model:c.data("model"),parent_field:b.data("name"),parent:c.data("id"),render:!0,_wpnonce:hivepressCoreData.apiNonce},start:function(){b.prop("disabled",!0),f.prop("disabled",!0),f.attr("data-state","loading"),d.length&&(d.prop("disabled",!0),d.attr("data-state","loading")),g.hide().html("")},stop:function(){b.prop("disabled",!1),f.prop("disabled",!1),f.attr("data-state",""),d.length&&(d.prop("disabled",!1),d.attr("data-state",""))},always:function(c,d){var e=d.jqXHR.responseJSON;e.hasOwnProperty("data")?b.prop("multiple")?h.append(e.data.html):h.html(e.data.html):e.hasOwnProperty("error")&&(e.error.hasOwnProperty("errors")?a.each(e.error.errors,function(a,b){g.append("<div>"+b.message+"</div>")}):e.error.hasOwnProperty("message")&&g.html("<div>"+e.error.message+"</div>"),!g.is(":empty")&&g.show())}})}),b.find(hivepress.getSelector("sortable")).each(function(){var b=a(this);b.sortable({stop:function(){1<b.children().length&&b.children().each(function(b){a.ajax({url:a(this).data("url"),method:"POST",data:{sort_order:b},beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",hivepressCoreData.apiNonce)}})})}})}),b.find(hivepress.getSelector("chart")).each(function(){var b=a(this),c=new Chart(b,{type:"line",options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}],xAxes:[{type:"time",time:{tooltipFormat:"MMM D, YYYY",unit:"week",displayFormats:{week:"MMM D, YYYY"}}}]}},data:{labels:b.data("labels"),datasets:b.data("datasets")}})});var c=b.find(hivepress.getSelector("form"));b.is("form")&&(c=b),c.each(function(){var b=a(this),c=b.find(".g-recaptcha"),d=a(".g-recaptcha").index(c.get(0)),e=b.find(":submit"),f=b.data("render");if(!0===b.data("autosubmit")&&b.on("change",function(){b.submit()}),f&&b.on("change",function(){var c=a("[data-block="+f.block+"]"),d=new FormData(b.get(0));c.length&&(d.append("_render",!0),d.delete("_wpnonce"),c.attr("data-state","loading"),a.ajax({url:f.url,method:"POST",data:d,contentType:!1,processData:!1,beforeSend:function(b){a("body").hasClass("logged-in")&&b.setRequestHeader("X-WP-Nonce",hivepressCoreData.apiNonce)},complete:function(b){var d=b.responseJSON;if("undefined"!=typeof d&&d.hasOwnProperty("data")&&d.data.hasOwnProperty("html")){var e=a(d.data.html);c.replaceWith(e),hivepress.initUI(e)}}}))}),b.on("submit",function(){e.prop("disabled",!0),e.attr("data-state","loading")}),b.data("action")){var g=b.find(hivepress.getSelector("messages")).first(),h=g.attr("class").split(" ")[0];b.on("submit",function(f){g.hide().html("").removeClass(h+"--success "+h+"--error"),"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave(),a.ajax({url:b.data("action"),method:"POST",data:new FormData(b.get(0)),contentType:!1,processData:!1,beforeSend:function(c){var d=b.data("method")?b.data("method"):b.attr("method");"POST"!==d&&c.setRequestHeader("X-HTTP-Method-Override",d),(a("body").hasClass("logged-in")||a("body").hasClass("wp-admin"))&&c.setRequestHeader("X-WP-Nonce",hivepressCoreData.apiNonce)},complete:function(f){var i=f.responseJSON,j=b.data("redirect");e.prop("disabled",!1),e.attr("data-state",""),"undefined"!=typeof grecaptcha&&c.length&&grecaptcha.reset(d),null==i||i.hasOwnProperty("data")?(b.data("message")&&307!==f.status&&g.addClass(h+"--success").html("<div>"+b.data("message")+"</div>").show(),j||307===f.status?"string"==typeof j?window.location.replace(j):window.location.reload(!0):(b.data("reset")||!b.is("[data-id]"))&&(b.trigger("reset"),b.find(hivepress.getSelector("file-upload")).each(function(){var b=a(this),c=b.closest("label"),d=c.parent().children("div").first();d.html("")}))):i.hasOwnProperty("error")&&(i.error.hasOwnProperty("errors")?a.each(i.error.errors,function(a,b){g.append("<div>"+b.message+"</div>")}):i.error.hasOwnProperty("message")&&g.html("<div>"+i.error.message+"</div>"),!g.is(":empty")&&g.addClass(h+"--error").show()),g.is(":visible")&&b.offset().top<a(window).scrollTop()&&a("html, body").animate({scrollTop:b.offset().top},500)}}),f.preventDefault()})}b.find("input[readonly], textarea[readonly]").on("click",function(){this.select(),document.execCommand("copy")})}),b.find(hivepress.getSelector("field")).each(function(){var b=a(this);if(b.data("parent")){var c=b.closest("form").find(":input[name=\""+b.data("parent")+"\"]");b.parent().is("td")?b=b.closest("tr"):b.is(":input")&&(b=b.closest("div")),c.length&&((!c.val()||c.is(":checkbox, :radio")&&!c.prop("checked"))&&b.hide(),c.on("change",function(){a(this).val()&&(!a(this).is(":checkbox, :radio")||a(this).prop("checked"))?b.show():b.hide()}))}}),a(document).trigger("hivepress:init",[b])},a(document).ready(function(){if(hivepress.dateFormatter=new DateFormatter,flatpickr.l10ns.hasOwnProperty(hivepressCoreData.language)){var b=flatpickr.l10ns[hivepressCoreData.language];flatpickr.localize(b),hivepress.dateFormatter=new DateFormatter({dateSettings:{days:b.weekdays.longhand,daysShort:b.weekdays.shorthand,months:b.months.longhand,monthsShort:b.months.shorthand,meridiem:b.hasOwnProperty("amPM")?b.amPM:["AM","PM"]}})}a(document).on("click tap touchstart",hivepress.getSelector("file-delete"),function(b){var c=a(this).parent();a.ajax({url:a(this).data("url"),method:"DELETE",beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",hivepressCoreData.apiNonce)}}),c.remove(),b.preventDefault()}),hivepress.initUI()})})(jQuery);