var hivepress={getSelector:function(e){return'[data-component="'+e+'"]'},getComponent:function(e){return jQuery(this.getSelector(e))}};!function(e){"use strict";e(document).ready(function(){hivepress.getComponent("link").on("click",function(t){var a=e(this).data("url");0!==a.indexOf("#")&&(window.location.href=a),t.preventDefault()}),hivepress.getComponent("modal").each(function(){var t="#"+e(this).attr("id");e('a[href="'+t+'"], button[data-url="'+t+'"]').on("click",function(a){e.fancybox.close(),e.fancybox.open({src:t,touch:!1}),a.preventDefault()})}),hivepress.getComponent("select").each(function(){var t=e(this),a={width:"100%",dropdownAutoWidth:!1,minimumResultsForSearch:20,templateResult:function(t){var a=t.text,n=0;return t.element&&(n=parseInt(e(t.element).data("level")),a=e("<div />").css("padding-left",20*n+"px").text(a)),a}};if(t.data("placeholder")&&(a.placeholder=t.data("placeholder")),"inline"===t.data("style")&&e.extend(a,{containerCssClass:"select2-selection--inline",dropdownCssClass:"select2-dropdown--inline",width:"resolve",dropdownAutoWidth:!0,minimumResultsForSearch:-1}),"icon"===t.data("template")){var n=function(e){var t=e.text;return e.id&&(t='<i class="fas fa-fw fa-'+e.id+'"></i> '+e.text),t};e.extend(a,{templateResult:n,templateSelection:n,escapeMarkup:function(e){return e}})}if(t.data("source"))if(e.extend(a,{ajax:{url:t.data("source"),dataType:"json",delay:250,cache:!0,data:function(e){return{search:e.term,context:"list",parent_value:t.data("parent-value"),_wpnonce:hivepressCoreData.apiNonce}},processResults:function(e){var t=[];return e&&e.hasOwnProperty("data")&&(t=e.data),{results:t}}}}),t.data("parent")){var r=t.closest("form").find(':input[name="'+t.data("parent")+'"]');r.length&&r.on("change",function(){t.data("parent-value",e(this).val())})}else a.minimumInputLength=3;t.data("input")&&e.extend(a,{tags:!0,tokenSeparators:[","]}),t.select2(a)});var t=new DateFormatter;if(flatpickr.l10ns.hasOwnProperty(hivepressCoreData.language)){var a=flatpickr.l10ns[hivepressCoreData.language];flatpickr.localize(a),t=new DateFormatter({dateSettings:{days:a.weekdays.longhand,daysShort:a.weekdays.shorthand,months:a.months.longhand,monthsShort:a.months.shorthand,meridiem:a.hasOwnProperty("amPM")?a.amPM:["AM","PM"]}})}hivepress.getComponent("date").each(function(){var a=e(this),n={allowInput:!0,altInput:!0,dateFormat:"Y-m-d",altFormat:"Y-m-d",defaultHour:0,disable:[],disableMobile:!0,onOpen:function(t,a,n){e(n.altInput).prop("readonly",!0),e(n.element).find("[data-clear]").show()},onClose:function(t,a,n){e(n.altInput).prop("readonly",!1),e(n.altInput).blur(),e(n.element).find("[data-clear]").hide(),e(n.element).data("reset")&&(n.clear(),e(n.element).data("reset",!1))}};if(a.is("div")&&(n.wrap=!0,n.altInputClass="",a.find("[data-clear]").on("click",function(){a.data("reset",!0)})),a.data("format")&&(n.dateFormat=a.data("format")),a.data("display-format")&&(n.altFormat=a.data("display-format")),a.data("min-date")&&(n.minDate=a.data("min-date")),a.data("max-date")&&(n.maxDate=a.data("max-date")),a.data("disabled-dates")&&(n.disable=a.data("disabled-dates")),a.data("disabled-days")){var r=a.data("disabled-days");if(r.length){n.disable.push(function(e){return-1!==r.indexOf(e.getDay())})}}if(a.is("[data-offset]")&&(n.minDate=(new Date).fp_incr(a.data("offset"))),a.is("[data-window]")&&(n.maxDate=(new Date).fp_incr(a.data("window"))),a.data("time")&&(n.enableTime=!0),a.data("mode")&&(n.mode=a.data("mode"),"range"===a.data("mode"))){var o=a.parent().find('input[type="hidden"]').not(a),s=a.data("min-length"),i=a.data("max-length");e.extend(n,{defaultDate:[o.eq(0).val(),o.eq(1).val()],errorHandler:function(e){},onChange:function(e,a,r){if(2===e.length){if(s||i){var d=Math.floor((e[1].getTime()-e[0].getTime())/864e5),l=0;d<s?l=s-d:d>i&&(l=i-d),l&&(e[1].setDate(e[1].getDate()+l),r.setDate(e),r.open())}var p=e.map(function(e){return t.formatDate(e,n.dateFormat)});o.eq(0).val(p[0]),o.eq(1).val(p[1])}else o.eq(0).val(""),o.eq(1).val("")}})}e.extend(n,{time_24hr:-1===n.altFormat.indexOf("a")&&-1===n.altFormat.indexOf("A"),parseDate:function(e){var a=t.parseDate(e,n.dateFormat);return"U"===n.dateFormat&&(a=new Date(a.toLocaleString("en-US",{timeZone:"UTC"}))),a},formatDate:function(e,a){var n=t.formatDate(e,a);return"U"===a&&(n=parseInt(n)-60*e.getTimezoneOffset()),n}}),a.flatpickr(n)}),hivepress.getComponent("time").each(function(){var a=e(this),n={allowInput:!0,altInput:!0,noCalendar:!0,enableTime:!0,dateFormat:"U",altFormat:"g:i A",defaultHour:0,disableMobile:!0,parseDate:function(e){var t=new Date;return t.setHours(Math.floor(e/3600)),t.setMinutes(Math.floor(e%3600/60)),t.setSeconds(e%60),t},formatDate:function(e,a){return"U"===a?3600*e.getHours()+60*e.getMinutes()+e.getSeconds():t.formatDate(e,a)},onOpen:function(t,a,n){e(n.altInput).prop("readonly",!0),e(n.element).find("[data-clear]").show()},onClose:function(t,a,n){e(n.altInput).prop("readonly",!1),e(n.altInput).blur(),e(n.element).find("[data-clear]").hide(),e(n.element).data("reset")&&(n.clear(),e(n.element).data("reset",!1))}};a.is("div")&&(n.wrap=!0,n.altInputClass="",a.find("[data-clear]").on("click",function(){a.data("reset",!0)})),a.data("display-format")&&(n.altFormat=a.data("display-format")),-1===n.altFormat.indexOf("a")&&-1===n.altFormat.indexOf("A")&&(n.time_24hr=!0),a.flatpickr(n)}),hivepress.getComponent("file-upload").each(function(){var t=e(this),a=t.parents("[data-model]:first"),n=t.closest("form").find(":submit"),r=t.closest("label"),o=r.find("button").first(),s=r.parent().find(hivepress.getSelector("messages")).first(),i=r.parent().children("div").first();t.fileupload({url:t.data("url"),dataType:"json",paramName:"file",formData:{parent_model:a.data("model"),parent_field:t.data("name"),parent:a.data("id"),render:!0,_wpnonce:hivepressCoreData.apiNonce},start:function(){t.prop("disabled",!0),o.prop("disabled",!0),o.attr("data-state","loading"),n.length&&(n.prop("disabled",!0),n.attr("data-state","loading")),s.hide().html("")},stop:function(){t.prop("disabled",!1),o.prop("disabled",!1),o.attr("data-state",""),n.length&&(n.prop("disabled",!1),n.attr("data-state",""))},always:function(a,n){var r=n.jqXHR.responseJSON;r.hasOwnProperty("data")?t.prop("multiple")?i.append(r.data.html):i.html(r.data.html):r.hasOwnProperty("error")&&(r.error.hasOwnProperty("errors")?e.each(r.error.errors,function(e,t){s.append("<div>"+t.message+"</div>")}):r.error.hasOwnProperty("message")&&s.html("<div>"+r.error.message+"</div>"),s.is(":empty")||s.show())}})}),e(document).on("click",hivepress.getSelector("file-delete"),function(t){var a=e(this).parent();e.ajax({url:e(this).data("url"),method:"DELETE",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",hivepressCoreData.apiNonce)}}),a.remove(),t.preventDefault()}),hivepress.getComponent("sortable").each(function(){var t=e(this);t.sortable({stop:function(){t.children().length>1&&t.children().each(function(t){e.ajax({url:e(this).data("url"),method:"POST",data:{sort_order:t},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",hivepressCoreData.apiNonce)}})})}})}),hivepress.getComponent("repeater").each(function(){var t=e(this),a=t.find("tbody"),n=t.find("tr:first");a.sortable({handle:"[data-sort]"}),n.length&&t.find("[data-add]").on("click",function(){var t=n.clone(),r=Math.random().toString(36).slice(2);r&&(t.find(":input").each(function(){var t=e(this),a=t.attr("name"),n=a.match(/\[([^\]]+)\]/);n&&t.attr("name",a.replace(n[1],r)),t.val("")}),t.appendTo(a))}),t.on("click","[data-remove]",function(){t.find("tr").length>1&&e(this).closest("tr").remove()})}),hivepress.getComponent("chart").each(function(){var t=e(this);new Chart(t,{type:"line",options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}],xAxes:[{type:"time",time:{tooltipFormat:"MMM D, YYYY",unit:"week",displayFormats:{week:"MMM D, YYYY"}}}]}},data:{labels:t.data("labels"),datasets:t.data("datasets")}})}),hivepress.getComponent("form").each(function(){var t=e(this),a=t.find(hivepress.getSelector("messages")).first(),n=a.attr("class").split(" ")[0],r=t.find(".g-recaptcha"),o=e(".g-recaptcha").index(r.get(0)),s=t.find(":submit");!0===t.data("autosubmit")&&t.on("change",function(){t.submit()}),t.on("submit",function(i){a.hide().html("").removeClass(n+"--success "+n+"--error"),s.prop("disabled",!0),s.attr("data-state","loading"),"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave(),t.data("action")&&(e.ajax({url:t.data("action"),method:"POST",data:new FormData(t.get(0)),contentType:!1,processData:!1,beforeSend:function(a){var n=t.data("method")?t.data("method"):t.attr("method");"POST"!==n&&a.setRequestHeader("X-HTTP-Method-Override",n),e("body").hasClass("logged-in")&&a.setRequestHeader("X-WP-Nonce",hivepressCoreData.apiNonce)},complete:function(i){var d=i.responseJSON,l=t.data("redirect");s.prop("disabled",!1),s.attr("data-state",""),"undefined"!=typeof grecaptcha&&r.length&&grecaptcha.reset(o),null==d||d.hasOwnProperty("data")?(t.data("message")&&307!==i.status&&a.addClass(n+"--success").html("<div>"+t.data("message")+"</div>").show(),l||307===i.status?"string"==typeof l?window.location.replace(l):window.location.reload(!0):!t.data("reset")&&t.is("[data-id]")||(t.trigger("reset"),t.find(hivepress.getSelector("file-upload")).each(function(){e(this).closest("label").parent().children("div").first().html("")}))):d.hasOwnProperty("error")&&(d.error.hasOwnProperty("errors")?e.each(d.error.errors,function(e,t){a.append("<div>"+t.message+"</div>")}):d.error.hasOwnProperty("message")&&a.html("<div>"+d.error.message+"</div>"),a.is(":empty")||a.addClass(n+"--error").show()),a.is(":visible")&&t.offset().top<e(window).scrollTop()&&e("html, body").animate({scrollTop:t.offset().top},500)}}),i.preventDefault())})})})}(jQuery);
