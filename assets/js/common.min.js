var hivepress={getSelector:function(a){return"[data-component=\""+a+"\"]"},getComponent:function(a){return jQuery(this.getSelector(a))}};(function(a){"use strict";hivepress.initUI=function(b=null){var c=Math.floor;null===b&&(b=a("body")),a(document).trigger("hivepress:init",[b]),b.find(hivepress.getSelector("link")).on("click",function(b){var c=a(this).data("url");0!==c.indexOf("#")&&(window.location.href=c),b.preventDefault()}),b.find(hivepress.getSelector("modal")).each(function(){var b="#"+a(this).attr("id");a("a[href=\""+b+"\"], button[data-url=\""+b+"\"]").on("click",function(c){a.fancybox.close(),a.fancybox.open({src:b,touch:!1}),c.preventDefault()})}),b.find(hivepress.getSelector("select")).each(function(){var b=a(this),c={width:"100%",dropdownAutoWidth:!1,minimumResultsForSearch:20,templateResult:function(b){var c=b.text,d=0;return b.element&&(d=parseInt(a(b.element).data("level")),c=a("<div />").css("padding-left",20*d+"px").text(c)),c}};if(b.data("placeholder")&&(c.placeholder=b.data("placeholder")),b.find("option[data-level]")&&(c.minimumResultsForSearch=-1),"inline"===b.data("style")&&a.extend(c,{containerCssClass:"select2-selection--inline",dropdownCssClass:"select2-dropdown--inline",width:"resolve",dropdownAutoWidth:!0,minimumResultsForSearch:-1}),"icon"===b.data("template")){var d=function(a){var b=a.text;return a.id&&(b="<i class=\"fas fa-fw fa-"+a.id+"\"></i> "+a.text),b};a.extend(c,{templateResult:d,templateSelection:d,escapeMarkup:function(a){return a}})}if(b.data("source"))if(a.extend(c,{ajax:{url:b.data("source"),dataType:"json",delay:250,cache:!0,data:function(a){return{search:a.term,context:"list",parent_value:b.data("parent-value"),_wpnonce:hivepressCoreData.apiNonce}},processResults:function(a){var b=[];return a&&a.hasOwnProperty("data")&&(b=a.data),{results:b}}}}),b.data("parent")){var e=b.closest("form").find(":input[name=\""+b.data("parent")+"\"]");e.length&&e.on("change",function(){b.data("parent-value",a(this).val())})}else c.minimumInputLength=3;b.data("input")&&a.extend(c,{tags:!0,tokenSeparators:[","]}),b.data("render")&&b.on("change",function(){var b=a(this).closest("[data-model]"),c=new FormData(a(this).closest("form").get(0));c.append("_id",b.data("id")),c.append("_model",b.data("model")),c.delete("_wpnonce"),b.attr("data-state","loading"),a.ajax({url:a(this).data("render"),method:"POST",data:c,contentType:!1,processData:!1,beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",hivepressCoreData.apiNonce)},complete:function(c){var d=c.responseJSON;if("undefined"!=typeof d&&d.hasOwnProperty("data")&&d.data.hasOwnProperty("html")){var e=a(d.data.html);b.replaceWith(e),hivepress.initUI(e)}}})}),b.select2(c)}),b.find(hivepress.getSelector("date")).each(function(){var b=a(this),d={allowInput:!0,altInput:!0,dateFormat:"Y-m-d",altFormat:"Y-m-d",defaultHour:0,disable:[],disableMobile:!0,onOpen:function(b,c,d){a(d.altInput).prop("readonly",!0),a(d.element).find("[data-clear]").show()},onClose:function(b,c,d){a(d.altInput).prop("readonly",!1),a(d.altInput).blur(),a(d.element).find("[data-clear]").hide(),a(d.element).data("reset")&&(d.clear(),a(d.element).data("reset",!1))}};if(b.is("div")&&(d.wrap=!0,d.altInputClass="",b.find("[data-clear]").on("click",function(){b.data("reset",!0)})),b.data("format")&&(d.dateFormat=b.data("format")),b.data("display-format")&&(d.altFormat=b.data("display-format")),b.data("min-date")&&(d.minDate=b.data("min-date")),b.data("max-date")&&(d.maxDate=b.data("max-date")),b.data("disabled-dates")&&(d.disable=b.data("disabled-dates")),b.data("disabled-days")){var e=b.data("disabled-days");if(e.length){d.disable.push(function(a){return-1!==e.indexOf(a.getDay())})}}if(b.data("ranges")){var f=b.data("ranges");d.onDayCreate=function(b,d,e,g){if(!g.className.includes("disabled")){var h=c(g.dateObj.getTime()/1e3)-60*g.dateObj.getTimezoneOffset();a.each(f,function(a,b){if(b.start<=h&&h<b.end)return g.innerHTML+="<span class=\"flatpickr-day-label\">"+b.label+"</span>",g.className+=" flatpickr-status",b.hasOwnProperty("status")&&(g.className+=" flatpickr-status--"+b.status),!1})}}}if(b.is("[data-offset]")&&(d.minDate=new Date().fp_incr(b.data("offset"))),b.is("[data-window]")&&(d.maxDate=new Date().fp_incr(b.data("window"))),b.data("time")&&(d.enableTime=!0),b.data("mode")&&(d.mode=b.data("mode"),"range"===b.data("mode"))){var g=b.parent().find("input[type=\"hidden\"]").not(b),h=b.data("min-length"),i=b.data("max-length");a.extend(d,{defaultDate:[g.eq(0).val(),g.eq(1).val()],errorHandler:function(){},onChange:function(a,b,e){if(2===a.length){if(h||i){var f=c((a[1].getTime()-a[0].getTime())/86400000),j=0;f<h?j=h-f:f>i&&(j=i-f),j&&(a[1].setDate(a[1].getDate()+j),e.setDate(a),e.open())}var k=a.map(function(a){return hivepress.dateFormatter.formatDate(a,d.dateFormat)});g.eq(0).val(k[0]),g.eq(1).val(k[1])}else g.eq(0).val(""),g.eq(1).val("")}})}a.extend(d,{time_24hr:-1===d.altFormat.indexOf("a")&&-1===d.altFormat.indexOf("A"),parseDate:function(a){var b=hivepress.dateFormatter.parseDate(a,d.dateFormat);return"U"===d.dateFormat&&(b=new Date(b.toLocaleString("en-US",{timeZone:"UTC"}))),b},formatDate:function(a,b){var c=hivepress.dateFormatter.formatDate(a,b);return"U"===b&&(c=parseInt(c)-60*a.getTimezoneOffset()),c}}),b.flatpickr(d)}),b.find(hivepress.getSelector("time")).each(function(){var b=a(this),d={allowInput:!0,altInput:!0,noCalendar:!0,enableTime:!0,dateFormat:"U",altFormat:"g:i A",defaultHour:0,disableMobile:!0,parseDate:function(a){var b=new Date;return b.setHours(c(a/3600)),b.setMinutes(c(a%3600/60)),b.setSeconds(a%60),b},formatDate:function(a,b){return"U"===b?3600*a.getHours()+60*a.getMinutes()+a.getSeconds():hivepress.dateFormatter.formatDate(a,b)},onOpen:function(b,c,d){a(d.altInput).prop("readonly",!0),a(d.element).find("[data-clear]").show()},onClose:function(b,c,d){a(d.altInput).prop("readonly",!1),a(d.altInput).blur(),a(d.element).find("[data-clear]").hide(),a(d.element).data("reset")&&(d.clear(),a(d.element).data("reset",!1))}};b.is("div")&&(d.wrap=!0,d.altInputClass="",b.find("[data-clear]").on("click",function(){b.data("reset",!0)})),b.data("display-format")&&(d.altFormat=b.data("display-format")),-1===d.altFormat.indexOf("a")&&-1===d.altFormat.indexOf("A")&&(d.time_24hr=!0),b.flatpickr(d)}),b.find(hivepress.getSelector("file-upload")).each(function(){var b=a(this),c=b.parents("[data-model]:first"),d=b.closest("form").find(":submit"),e=b.closest("label"),f=e.find("button").first(),g=e.parent().find(hivepress.getSelector("messages")).first(),h=e.parent().children("div").first();b.fileupload({url:b.data("url"),dataType:"json",paramName:"file",formData:{parent_model:c.data("model"),parent_field:b.data("name"),parent:c.data("id"),render:!0,_wpnonce:hivepressCoreData.apiNonce},start:function(){b.prop("disabled",!0),f.prop("disabled",!0),f.attr("data-state","loading"),d.length&&(d.prop("disabled",!0),d.attr("data-state","loading")),g.hide().html("")},stop:function(){b.prop("disabled",!1),f.prop("disabled",!1),f.attr("data-state",""),d.length&&(d.prop("disabled",!1),d.attr("data-state",""))},always:function(c,d){var e=d.jqXHR.responseJSON;e.hasOwnProperty("data")?b.prop("multiple")?h.append(e.data.html):h.html(e.data.html):e.hasOwnProperty("error")&&(e.error.hasOwnProperty("errors")?a.each(e.error.errors,function(a,b){g.append("<div>"+b.message+"</div>")}):e.error.hasOwnProperty("message")&&g.html("<div>"+e.error.message+"</div>"),!g.is(":empty")&&g.show())}})}),b.find(hivepress.getSelector("sortable")).each(function(){var b=a(this);b.sortable({stop:function(){1<b.children().length&&b.children().each(function(b){a.ajax({url:a(this).data("url"),method:"POST",data:{sort_order:b},beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",hivepressCoreData.apiNonce)}})})}})}),b.find(hivepress.getSelector("repeater")).each(function(){var b=a(this),c=b.find("tbody"),d=b.find("tr:first");c.sortable({handle:"[data-sort]"}),d.length&&b.find("[data-add]").on("click",function(){var b=d.clone(),e=Math.random().toString(36).slice(2);e&&(b.find(":input").each(function(){var b=a(this),c=b.attr("name"),d=c.match(/\[([^\]]+)\]/);if(d&&b.attr("name",c.replace(d[1],e)),"checkbox"===b.attr("type")){var f="a"+Math.random().toString(36).slice(2);b.attr("id",f),b.closest("label").attr("for",f)}else b.val("")}),b.appendTo(c)),hivepress.initUI(b)}),b.on("click","[data-remove]",function(){1<b.find("tr").length&&a(this).closest("tr").remove()})}),b.find(hivepress.getSelector("chart")).each(function(){var b=a(this),c=new Chart(b,{type:"line",options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}],xAxes:[{type:"time",time:{tooltipFormat:"MMM D, YYYY",unit:"week",displayFormats:{week:"MMM D, YYYY"}}}]}},data:{labels:b.data("labels"),datasets:b.data("datasets")}})});var d=b.find(hivepress.getSelector("form"));b.is("form")&&(d=b),d.each(function(){var b=a(this),c=b.find(".g-recaptcha"),d=a(".g-recaptcha").index(c.get(0)),e=b.find(":submit");if(!0===b.data("autosubmit")&&b.on("change",function(){b.submit()}),b.on("submit",function(){e.prop("disabled",!0),e.attr("data-state","loading")}),b.data("action")){var f=b.find(hivepress.getSelector("messages")).first(),g=f.attr("class").split(" ")[0];b.on("submit",function(h){f.hide().html("").removeClass(g+"--success "+g+"--error"),"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave(),a.ajax({url:b.data("action"),method:"POST",data:new FormData(b.get(0)),contentType:!1,processData:!1,beforeSend:function(c){var d=b.data("method")?b.data("method"):b.attr("method");"POST"!==d&&c.setRequestHeader("X-HTTP-Method-Override",d),(a("body").hasClass("logged-in")||a("body").hasClass("wp-admin"))&&c.setRequestHeader("X-WP-Nonce",hivepressCoreData.apiNonce)},complete:function(h){var i=h.responseJSON,j=b.data("redirect");e.prop("disabled",!1),e.attr("data-state",""),"undefined"!=typeof grecaptcha&&c.length&&grecaptcha.reset(d),null==i||i.hasOwnProperty("data")?(b.data("message")&&307!==h.status&&f.addClass(g+"--success").html("<div>"+b.data("message")+"</div>").show(),j||307===h.status?"string"==typeof j?window.location.replace(j):window.location.reload(!0):(b.data("reset")||!b.is("[data-id]"))&&(b.trigger("reset"),b.find(hivepress.getSelector("file-upload")).each(function(){var b=a(this),c=b.closest("label"),d=c.parent().children("div").first();d.html("")}))):i.hasOwnProperty("error")&&(i.error.hasOwnProperty("errors")?a.each(i.error.errors,function(a,b){f.append("<div>"+b.message+"</div>")}):i.error.hasOwnProperty("message")&&f.html("<div>"+i.error.message+"</div>"),!f.is(":empty")&&f.addClass(g+"--error").show()),f.is(":visible")&&b.offset().top<a(window).scrollTop()&&a("html, body").animate({scrollTop:b.offset().top},500)}}),h.preventDefault()})}b.find("input[readonly], textarea[readonly]").on("click",function(){this.select(),document.execCommand("copy")})}),b.find(hivepress.getSelector("field")).each(function(){var b=a(this);if(b.data("parent")){var c=b.closest("form").find(":input[name=\""+b.data("parent")+"\"]");b.parent().is("td")?b=b.closest("tr"):b.is(":input")&&(b=b.closest("div")),c.length&&((!c.val()||c.is(":checkbox, :radio")&&!c.prop("checked"))&&b.hide(),c.on("change",function(){a(this).val()&&(!a(this).is(":checkbox, :radio")||a(this).prop("checked"))?b.show():b.hide()}))}})},a(document).ready(function(){if(hivepress.dateFormatter=new DateFormatter,flatpickr.l10ns.hasOwnProperty(hivepressCoreData.language)){var b=flatpickr.l10ns[hivepressCoreData.language];flatpickr.localize(b),hivepress.dateFormatter=new DateFormatter({dateSettings:{days:b.weekdays.longhand,daysShort:b.weekdays.shorthand,months:b.months.longhand,monthsShort:b.months.shorthand,meridiem:b.hasOwnProperty("amPM")?b.amPM:["AM","PM"]}})}a(document).on("click",hivepress.getSelector("file-delete"),function(b){var c=a(this).parent();a.ajax({url:a(this).data("url"),method:"DELETE",beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",hivepressCoreData.apiNonce)}}),c.remove(),b.preventDefault()}),hivepress.initUI()})})(jQuery);